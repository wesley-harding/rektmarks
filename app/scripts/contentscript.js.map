{"version":3,"sources":["app/scripts.babel/contentscript.js"],"names":[],"mappings":"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","file":"app/scripts.babel/contentscript.js","sourcesContent":["'use strict';\n\n/*\n  Functionality\n */\nvar $ = jQuery;\n$(document ).ready(function(){\n    var rektmarks_marks = [{\n        id: '1',\n        date: new Date(),\n        title: 'test',\n        description: 'test description',\n        url: 'https://media.giphy.com/media/Br7B9CakrA1ig/giphy.gif'\n    }];\n\n    var contextMenuDetails = {\n        \"title\": \"Rektmark This\",\n        \"contexts\": [\n            \"page\", \"link\", \"image\", /*\"video\",*/ \"browser_action\", \"page_action\" ],\n        \"onclick\": handleContextMenuClick\n    };\n\n    /* Dom selectors */\n    var $cards, $sidebar, $dropzone, $close, $newcardarea, $submit_new;\n\n    function initialize() {\n        var doEventBinding = false;\n\n        //Inject the sidebar\n        if(typeof $sidebar === 'undefined') {\n            $( sideBarMarkup() ).appendTo( 'body' );\n            $sidebar = $( '#rektmarks_sidebar' );\n            $dropzone = $('#rektmarks_dropzone');\n            doEventBinding = true;\n        }\n\n\n        if(typeof $close === 'undefined') {\n            $close = $('#rektmarks_close');\n        }\n\n        if(typeof $newcardarea === 'undefined'){\n            $newcardarea = $('#rektmarks_new_card_container')\n        }\n\n        if(typeof chrome['contextMenus'] !== 'undefined'){\n            chrome.contextMenus.create(contextMenuDetails, function(){\n                console.log('Added context menu');\n            });\n        }\n\n        //Inject the cards\n        if(typeof $cards === 'undefined') {\n            $cards = $('#rektmarks_cards');\n            clearCards($cards);\n            injectCards($cards);\n        }\n\n        if( doEventBinding ){\n            bindEvents();\n        }\n    }\n\n\n    function validateCard(cardDetails) {\n        //TODO: Write validation\n    }\n\n    function addCard(cardDetails){\n        /* Required */\n        var url = cardDetails.url;\n        /* Optional */\n        var title = cardDetails.title;\n        var description = cardDetails.description;\n        var type = cardDetails.type;\n        /* Generated */\n        var id = psuedoUUID();\n        var date = new Date();\n\n        var card = {\n            id,\n            date,\n            url,\n            title,\n            description,\n            type\n        };\n\n        // Unshift so were added to the beginning\n        rektmarks_marks.unshift(card);\n\n        return card;\n    }\n\n    function insertNewCard(cardDetails) {\n        var markup = cardMarkup(cardDetails);\n        $cards.prepend(markup);\n    }\n\n    function injectCards($target) {\n        rektmarks_marks.forEach(function(card, index){\n            var markup = cardMarkup(card);\n            $(markup).appendTo($target);\n        });\n    }\n\n    function clearCards($target) {\n        $target.html('');\n    }\n\n    function bindEvents() {\n        $dropzone.on('drop', function(event){\n            event.stopPropagation();\n            event.preventDefault();\n        });\n        $dropzone.on('dragend drop', function(event){\n            hideDropArea();\n            event.stopPropagation();\n        });\n        $dropzone.on('dragenter', function(){\n            $dropzone.addClass('rektmarks_over');\n        });\n        $dropzone.on('dragleave dragend drop', function(){\n            $dropzone.removeClass( 'rektmarks_over' );\n        });\n        $dropzone.on('drop', function(event){\n            var src = event.originalEvent.dataTransfer.getData( 'application/json' );\n            src = JSON.parse(src);\n            showNewCard(src);\n        });\n        $close.on('click', function(){\n            hideSidebar();\n        });\n        $( 'body' ).on( 'dragstart', function ( event ) {\n            var src = extractSource(event.target);\n\n            showSidebar();\n            showDropArea();\n\n            event.originalEvent.dataTransfer.effectAllowed = 'all';\n            event.originalEvent.dataTransfer.setData( 'application/json',  JSON.stringify(src));\n        } );\n    }\n\n    function extractSource(target) {\n        if(target.tagName == 'IMG') {\n            return {\n                type: 'IMG',\n                src: target.src\n            };\n        }\n\n        if(target.tagName == 'a') {\n            return {\n                type: 'a',\n                src: target.href\n            }\n        }\n\n        return false;\n    }\n\n    function showSidebar() {\n        $sidebar.show();\n    }\n\n    function hideSidebar() {\n        $sidebar.hide();\n        hideNewCard();\n    }\n\n    function showDropArea(){\n        $dropzone.show();\n    }\n    function hideDropArea(){\n        $dropzone.hide();\n    }\n    function showNewCard(details){\n\n        var markup = newCardMarkup(details);\n        $newcardarea.html(markup);\n\n        $submit_new = $( '#rektmarks_save' );\n        $submit_new.on('click', submitNewCard);\n    }\n    function hideNewCard(){\n        $newcardarea.html('');\n    }\n    function submitNewCard() {\n        var title = $('#rektmarks_new_title').val();\n        var url = $('#rektmarks_new_src').attr('src');\n        var description = $('#rektmarks_new_description').val();\n        var type = $('#rektmarks_new_type').val();\n\n        var newCard = addCard( {\n            url,\n            title,\n            description,\n            type\n        } );\n        hideNewCard();\n        insertNewCard( newCard );\n    }\n\n    function handleContextMenuClick(){\n        console.log('Menu clicked');\n    }\n\n    function psuedoUUID() {\n        var d = new Date().getTime();\n        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace( /[xy]/g, function ( c ) {\n            var r = (d + Math.random() * 16) % 16 | 0;\n            d = Math.floor( d / 16 );\n            return (c == 'x' ? r : (r & 0x3 | 0x8)).toString( 16 );\n        } );\n        return uuid;\n    }\n\n    function sideBarMarkup() {\n        return `\n            <div id=\"rektmarks_sidebar\" style=\"display: none;\">\n                <div id=\"rektmarks_dropzone\"  ondragover=\"event.preventDefault()\" style=\"display: none\">Get Rekt</div>\n                <div id=\"rektmarks_close\">X</div>\n                <h1>Rektmarks</h1>\n                <h4><a href=\"http://github.com/wesley-harding/rektmarks\" target=\"_blank\">Rek my source!</a></h4>\n                <input type=\"search\" placeholder=\"Search (coming soon)\">\n                <div id=\"rektmarks_new_card_container\">\n                </div>\n                <hr>\n                <div id=\"rektmarks_cards\">\n                    <h5>Whoops! You have no bookmarks</h5>\n                </div>\n            </div>\n        `;\n    }\n\n    function cardMarkup(cardDetails) {\n        return `\n            <div class=\"rektmarks_card\" data-rektmarks-id=\"${cardDetails.id}\">\n                <h2 class=\"rektmarks_card_title\">${cardDetails.title || ''}</h2>\n                <div class=\"rektmarks_card_preview\">\n                    <!-- TODO: Let's actually check if this is an image -->\n                    <a href=\"${cardDetails.url}\" target=\"_blank\">\n                        <img class=\"rektmarks_card_url\" src=\"${cardDetails.url}\" alt=\"Preview\">\n                    </a>\n                </div>\n                <a class=\"rektmarks_card_src\" href=\"${cardDetails.url}\" target=\"_blank\">${cardDetails.url.substring(0, 40)}</a>\n                <p class=\"rektmarks_card_description\">${cardDetails.description}</p>\n                <span class=\"rektmarks_card_date\">${cardDetails.date}</span>\n            </div>\n        `;\n    }\n\n    function newCardMarkup(cardDetails){\n        return `\n            <hr>\n            <div id=\"rektmarks_new_card\">\n                <input id=\"rektmarks_new_title\" type=\"text\" placeholder=\"Name\">\n                <img id=\"rektmarks_new_src\" src=\"${cardDetails.src}\" alt=\"Preview\">\n                <textarea id=\"rektmarks_new_description\" placeholder=\"Description\"></textarea>\n                <input id=\"rektmarks_new_type\" type=\"hidden\" value=\"${cardDetails.type}\">\n                <button id=\"rektmarks_save\">Rekt It</button>\n            </div>\n        `;\n    }\n\n    /*\n     Run\n     */\n\n\n    console.info( 'Loading Rektmarks' );\n    initialize();\n});\n"]}