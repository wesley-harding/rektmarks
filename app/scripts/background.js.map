{"version":3,"sources":["app/scripts.babel/background.js"],"names":[],"mappings":"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","file":"app/scripts.babel/background.js","sourcesContent":["'use strict';\n\nchrome.runtime.onInstalled.addListener(details => {\n  console.log('previousVersion', details.previousVersion);\n});\n\nchrome.browserAction.setBadgeText({text: '\\'Allo'});\n\nconsole.log('\\'Allo \\'Allo! Event Page for Browser Action. Test');\n\nchrome.runtime.onMessage.addListener(\n    function(request, sender, sendResponse){\n        console.log('received message' +  request.action);\n        if(request.action == 'deleteCard') {\n            return deleteCard(request, sender, sendResponse);\n        } else if(request.action == 'addCard') {\n            return addCard(request, sender, sendResponse);\n        } else if (request.action == 'syncCards') {\n            return syncCards(request, sender, sendResponse);\n        }\n    }\n);\n\nfunction deleteCard(request, sender, sendResponse){\n    chrome.storage.sync.get('cards', function(result){\n        var cards = result['cards'] || [];\n        var needleId = request.data.cardId;\n        var foundCardIndex;\n        var deletedCard;\n\n        if(needleId) {\n            cards.forEach(function(card, index){\n                if(card.id == needleId) {\n                    console.log(\"Found Card\");\n                    foundCardIndex = index;\n                }\n            });\n\n            if(foundCardIndex){\n                deletedCard = cards.splice(foundCardIndex,1);\n\n                if(deletedCard.length > 0) {\n                    deletedCard = deletedCard[0];\n                } else {\n                    deletedCard = undefined;\n                }\n\n            }\n        }\n\n        if(deletedCard) {\n            console.log('Found card. Now deleting');\n            chrome.storage.sync.set( {\n                cards\n            }, function () {\n                sendResponse({\n                    response: 'deleteCard',\n                    data: {\n                        deletedCard: deletedCard,\n                        cards: cards\n                    }\n                });\n            } );\n        } else {\n            sendResponse({\n                response: 'deleteCard',\n                data: {\n                    deletedCard: undefined,\n                    cards: cards\n                }\n            });\n        }\n\n\n    });\n    return true;\n}\n\nfunction addCard(request, sender, sendResponse) {\n    chrome.storage.sync.get( 'cards', function ( result ) {\n        var cards = result[ 'cards' ] || [];\n        var card = request.data.card;\n\n        if(card) {\n            cards.unshift(card);\n\n            chrome.storage.sync.set({\n                cards\n            }, function(){\n               sendResponse({\n                   response: 'addCard',\n                   data: {\n                       card,\n                       cards\n                   }\n               })\n            });\n\n        } else {\n            sendResponse({\n                response: 'addCard',\n                data: {\n                    addedCard: undefined,\n                    cards: cards\n                }\n            })\n        }\n\n    });\n\n    return true;\n}\n\nfunction syncCards(request, sender, sendResponse) {\n    console.log('Syncing chards');\n    chrome.storage.sync.get('cards', function(result){\n        var cards = result['cards'] || [];\n        console.log( 'send sync response' );\n        console.info(cards);\n        console.info(result);\n\n        sendResponse({\n            response: 'syncCards',\n            data: {\n                cards\n            }\n        });\n    });\n    return true;\n}\n"]}